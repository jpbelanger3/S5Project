<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/stylesheets/accueil.css"/>
        <link rel="stylesheet" type="text/css" href="/dependencies/font-awesome-4.7.0/css/font-awesome.min.css"/>
        <meta charset="utf-8"/>
        <title>Hypo</title>
    </head>
    <body>
        <div id="global">
            <div id="session-context">
                <label for="module-list">Module: </label>
                <select id="module" onchange="moduleSwitch(this.value)">
                    <% modules.forEach((module) => { %>
                        <option value= <%= module.id %> <%= module.id === selectedModuleId? 'selected' : '' %> >
                            <%= module.name %>
                        </option>
                    <% }) %>
                </select>
                <button id="logout-button" class="fa fa-sign-out" onClick="logout()"></button>
            </div>

            <!--Menu Vertical Gauche-->
            <nav>
                <ul id="menu">
                    <li class="image1" id="pic1"></li>
                    <li class="image1" id="pic2"></li>
                    <li class="image1 sub-menu" id="click_action"></li>  
                        <ul id="subMenu">
                            <li class="image2" id="pic4"></li>
                            <li class="image2" id="pic5"></li>
                            <li class="image2" id="pic6"></li>
                        </ul>
                    <li class="image1" id="pic7"></li>
                    <li class="image1" id="pic8"></li>
                </ul> 
            </nav>
            <!-- Fin Menu Vertical Gauche-->

            <!-- Début page 'Home'-->
            <div id="page_home" class="page_begins">
                <section id="section2">
                    <div id="sensor_values_table">
                        <div id="top_table">
                            <div class="table_line">
                                <div class="sensor_values">
                                    <label>Valeur température (°C)</label>
                                    <span>22.3</span>
                                </div>
                                <div id="icone_representation1" class="icone_representation"></div>
                            </div>
                            <div class="table_line">
                                <div class="sensor_values">
                                    <label>Valeur PH</label>
                                    <span>22.3</span>
                                </div>
                                <div id="icone_representation2" class="icone_representation"></div>
                            </div>
                            <div class="table_line">
                                <div class="sensor_values">
                                    <label>Niveau de fertilisant</label>
                                    <span id="fertilisant_span"></span>
                                </div>
                                <div id="icone_representation3" class="icone_representation"></div>
                            </div>
                            <div id="table_line">
                                <div id="sensor_value">
                                    <label>Eclairage</label>
                                    <span></span>
                                </div>
                                <div id="icone_representation4"></div>
                            </div>
                        </div>
                    </div>
                    <div id="picture_home"></div>
                </section>
            </div>
            <!-- Fin page 'Home' -->

            <!-- Début page 'Settings' -->
            <div id="page_settings" class="page_begins">
                <section id="section1">
                    <div id="choix_utilisateur">
                        <div id="button1_div">
                            <input type="button" value="Importer"/>
                            <input type="button" value="Création"/>
                            <input type="button" value="Sauvegarder"/>
                        </div>
                        <div id="liste_deroulante">
                            <form method="post" action="???">
                                <select name="profil" id="profil">
                                    <option value="profil1">Mon Profil</option>
                                    <option value="profil2">Mon Autre Profil</option>
                                </select>
                            </form>
                        </div>
                    </div>

                    <label class="label_deroulant" id="temp_action">Température</label>
                    <div class="section1_div" id="temperature">
                        <div class="param_div">
                            <label>Min (°C)</label>
                            <form type="" method=""> 
                                <span class="param_value">
                                    <input type="text" name="min_temp" value="18.3"/>
                                </span>  
                            </form>
                        </div>
                        <div class="param_div">
                            <label>Max (°C)</label>
                            <form type="" method=""> 
                                <span class="param_value">
                                    <input type="text" name="max_temp" value="25.7"/>
                                </span>  
                            </form>
                        </div>
                    </div>

                    <label class="label_deroulant" id="ph_action">PH</label>
                    <div class="section1_div" id="ph">
                        <div class="param_div">
                            <label>Min</label>
                            <form type="" method="post"> 
                                <span class="param_value">
                                    <input type="text" name="min_ph" value="0"/>
                                </span>  
                            </form>
                        </div>
                        <div class="param_div">
                            <label>Max</label>
                            <form type="" method="post"> 
                                <span class="param_value">
                                    <input type="text" name="max_ph" value="14"/>
                                </span>  
                            </form>
                        </div>
                    </div>

                    <label class="label_deroulant" id="fert_action">Fertilisant</label>
                    <div class="section1_div" id="fertilisant">
                        <div class="param_div">
                            <label>EC (mS/cm)</label>
                        </div>
                        <div id="param_div">
                            <form>
                                <output class="param_value" id="range_value" name="resultat"></output>
                                <input id="fert_range" type="range" name="d" list="tickmarks" min="0" max="100" step="0.5" oninput="resultat.value=parseInt(d.value)"/>
                            </form>  

                            <datalist id="tickmarks">
                                <option value="0" label="0">
                                <option value="10">
                                <option value="20">
                                <option value="30">
                                <option value="40">
                                <option value="50" label="50">
                                <option value="60">
                                <option value="70">
                                <option value="80">
                                <option value="90">
                                <option value="100" label="100">
                            </datalist>
                        </div>
                    </div>

                    <label id="ecla_action" class="label_deroulant">Eclairage</label>
                    <div id="eclairage" class="section1_div">
                        <div class="param_div">
                            <label>LX (cd.sr.m<sub>-2</sub>)</label>
                        </div>
                        <div id="param_div">
                            <form>
                                <output class="param_value" id="range_value" name="resultat"></output>
                                <input id="fert_range" type="range" name="d" list="tickmarks" min="0" max="100" step="0.5" oninput="resultat.value=parseInt(d.value)"/>
                            </form>  

                            <datalist id="tickmarks">
                                <option value="0" label="0">
                                <option value="10">
                                <option value="20">
                                <option value="30">
                                <option value="40">
                                <option value="50" label="50">
                                <option value="60">
                                <option value="70">
                                <option value="80">
                                <option value="90">
                                <option value="100" label="100">
                            </datalist>
                        </div>
                    </div>

                    <label id="phot_action" class="label_deroulant">Photo</label>
                    <div class="section1_div" id="photo">
                        <div class="param_div">
                            <label>Photo (par jour)</label>
                            <form type="" method="post"> 
                                <span class="param_value">
                                    <input type="text" name="freq_photo" value="1"/>
                                </span>  
                            </form>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Fin page 'Settings'-->

            <!-- Début page temperature graphics -->
            <div id="page_temp_graph" class="page_begins">
                <section id="section4">
                    <div class="WIP">Work In Progress</div>
                </section>
            </div>
            <!-- Fin page temperature graphics -->

            <!-- Début page ph graphics -->
            <div id="page_ph_graph" class="page_begins">
                <section id="section5">
                    <div class="WIP">Work In Progress</div>
                </section>
            </div>
            <!-- Fin page ph graphics -->

            <!-- Début page fertilisant graphics -->
            <div id="page_fert_graph" class="page_begins">
                <section id="section6">
                    <div class="WIP">Work In Progress</div>
                </section>
            </div>
            <!-- Fin page fertilisant graphics -->

            <!-- Début page 'Pictures' -->
            <div id="page_picture" class="page_begins">
                <section id="section7">
                    <div class="section1_div" id="photo">
                        <div id="photo_split">
                            <div id="left_block">
                                <div class="left_pics">
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                </div>
                                <div class="left_pics">
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                </div>
                                <div class="left_pic">
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                </div>
                                <div class="left_pic">
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                    <img class="plant_picture" src="/images/NO_ID.png"/>
                                </div>
                            </div>                            
                            <div id="right_pic">
                                <img class="plant_picture" src="/images/NO_ID_BIG.png"/>
                            </div>
                        </div>
                    </div>
                </section>
            </div>  
            <!-- Fin page 'Pictures' -->

            <!-- Début page Forum -->
            <div id="page_forum" class="page_begins">
                <section id="section8">
                    <div class="WIP">Work In Progress</div>
                </section>
            </div>
            <!-- Fin page Forum -->

            <footer>

            </footer>
        </div>

        <script src="/dependencies/jquery-3.2.1.min.js"></script>
        
<!-- script pour mettre à jour la valeur actuelle de l'input range dans un output-->
        <script>
            $(function() {
                $('#fert_range').next().text('--'); // Valeur par défaut
                $('#fert_range').on('input', function() {
                    var $set = $(this).val();
                    $(this).next().text($set);
                });
            });
        </script>
        
<!-- script pour cacher/afficher le sous menu de l'icone n°3 -->
        <script type="text/javascript">
            jQuery(document).ready(function($){
                $("#subMenu").hide();
                $("#click_action").on("click", function(){
                    $("#subMenu").toggle("fast");
                });
            });
        </script>
        
<!-- script pour cacher/afficher les informations de la page "settings" -->
        <script type="text/javascript">
            jQuery(document).ready(function($){
                $("#temperature").hide()
                $("#ph").hide()
                $("#fertilisant").hide()
                $("#eclairage").hide()
                $("#photo").hide()

                $("#temp_action").on("click", function(){
                    $("#temperature").slideToggle("fast")
                })
                $("#ph_action").on("click", function(){
                    $("#ph").slideToggle("fast")
                })
                $("#fert_action").on("click", function(){
                    $("#fertilisant").slideToggle("fast")
                })
                $("#ecla_action").on("click", function(){
                    $("#eclairage").slideToggle("fast")
                })
                $("#phot_action").on("click", function(){
                    $("#photo").slideToggle("fast")
                })
            })
        </script>
        
<!-- script pour cacher/afficher les différentes pages (à améliorer mais utile pour voir ce que ça donne) -->
        <script type="text/javascript">
            jQuery(document).ready(function($){
                $(".page_begins").hide()
                
                $("#pic1").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_home").show(0)
                })
                $("#pic2").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_settings").show(0)
                }) 
                $("#pic4").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_temp_graph").show(0)
                })
                $("#pic5").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_ph_graph").show(0)
                })
                $("#pic6").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_fert_graph").show(0)
                })
                $("#pic7").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_picture").show(0)
                })
                $("#pic8").on("click", function(){
                    $(".page_begins").hide()
                    $("#page_forum").show(0)
                }) 
            })
        </script>

<!-- -->
        <script>
            document.getElementById("image1").onclick = function(){
                var id = this.getAttribute('id')
                document.getElementById('range_value').innerHTML = id
            } 
        </script>

<!-- -->
        <script>
            jQuery(document).ready(function($){
                var elmt;    
                $(".image1").on("click", function() {
                    window.menuSwitch(this)   
                })
                $(".image2").on("click", function() {
                    window.menuSwitch(this)   
                })
                   
            });
        </script>

<!-- -->
        <script>
            (function(ns) {
                var lastSelectedMenu

                function menuSwitch(selectedElem) {
                    $(lastSelectedMenu).removeClass('selected')
                    if (!($(selectedElem).hasClass('sub-menu'))) {
                        $(selectedElem).addClass('selected')
                    }
                    
                    lastSelectedMenu = selectedElem
                }

                function moduleSwitch(moduleId) {
                    $.ajax({
                        type: 'PUT',
                        url: '/module/switch/' + moduleId,
                        success: () => {
                            window.location.href = '/'
                        }
                    })
                }

                function logout() {
                    $.ajax({
                        type: 'POST',
                        url: '/logout',
                        success: () => {
                            window.location.href = '/'
                        }
                    })
                }

                ns.logout = logout
                ns.menuSwitch = menuSwitch
                ns.moduleSwitch = moduleSwitch
            }(window))
        </script>
    </body>    
</html>